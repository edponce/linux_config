#!/bin/sh

errmsg="\033[01;31mERROR\033[00m"
warnmsg="\033[01;33mWARNING\033[00m"

usage()
{
cat << _USAGE_
Usage: $(basename $0) [--help] "APPLICATION" "ARGS"

Wrapper to invoke an application and clear terminal after its completion.
_USAGE_
}

# Default options
app=""

# Get command line options
while [ "$1" ]; do
    case "$1" in
        -h | --help) usage
            exit 0 ;;
        *) app="$@"
            shift $# ;;
    esac
done

# Validate
if [ -z "$app" ]; then
    printf "%b\n" "$errmsg: no application was specified"
    exit 1
fi

# [ENV_VAR=value] app [args]
appname="$(printf "$app" | sed 's/\b\w\+=\S*\s\b//g' | awk '{ print $1 }')"
if [ ! "$(command -v "$appname")" ] && [ ! -x "$appname" ]; then
    printf "%b\n" "$errmsg: application '$appname' was not found"
    exit 1
fi

# Run
eval $app; [ $? -eq 0 ] || exit 1
tput clear

