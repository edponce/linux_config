#!/bin/sh
# NOTE: unsafe use of 'eval' as it allows user inputs without sanity checks.

errmsg="\033[01;31mERROR\033[00m"
warnmsg="\033[01;33mWARNING\033[00m"

usage()
{
cat << _USAGE_
Usage: $(basename $0) [--help] "APPLICATION" "ARGS"

Wrapper to invoke an application and clear terminal after its completion.
_USAGE_
}

# Default options
app_cmd=""

# Get command line options
while [ "$1" ]; do
    case "$1" in
        -h | --help) usage
            exit 0 ;;
        *) app_cmd="$@"
            shift $# ;;
    esac
done

# Validate
if [ -z "$app_cmd" ]; then
    printf "%b\n" "$errmsg: no application was specified"
    exit 1
fi

# [ENV_VAR=value] app_name [args]
app_name="$(printf "$app_cmd" | sed 's/\b\w\+=\S*\s\b//g' | cut -d ' ' -f 1)"
if [ ! "$(command -v "$app_name")" ]; then
    printf "%b\n" "$errmsg: application '$app_name' was not found"
    exit 1
fi

# Run
eval $app_cmd
tput clear

