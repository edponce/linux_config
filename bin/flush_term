#!/bin/bash 

. $HOME/bin/error_utils
. $HOME/bin/custom_utils

usage()
{
cat << _EOF_
Usage: $(basename $0) [--help] [--row ROW]

Clears terminal window after having the specified empty rows.

Default is to not leave empty rows.
_EOF_
}

# Default options
empty_rows=0

# Get command line options
while [ "$1" ]; do
    case "$1" in
        -h | --help)
            usage
            exit 0
            ;;
        -r | --row)
            empty_rows=$2
            shift 2 
            ;;
        *)
            usage
            error_msg "invalid command line option, $1" 1
            ;;
    esac
done

# Get terminal window maximum number of rows
max_rows=$(tput lines)

# Validate
if [ $empty_rows -lt 0 ]; then
    error_msg "invalid empty rows value" 1
fi
if [ $empty_rows -ge $max_rows ]; then
    warn_msg "adjusting empty rows to maximum rows in terminal window"
    empty_rows=$((max_rows - 1))
fi

# Get current cursor row in terminal window
curr_pos=($(get_cursor_pos))

# Run
if [ $((max_rows - ${curr_pos[0]})) -le $empty_rows ]; then
    tput clear
fi

exit 0

