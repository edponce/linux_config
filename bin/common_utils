#!/bin/sh

# Find single file on current directory containing the given extension.
# Links and directories are not considered.
# If none or multiple files are found, an empty string is returned.
#
# Inputs: file_ext
# Outputs: echo "${file_list[@]}"
# Usage: find_file_ext .cpp
#        find_file_ext cpp
#        find_file_ext .TAR.gz
find_file_ext()
{
    file_ext="$(echo "$1" | tr '[:upper:]' '[:lower:]')"
    file_list=""
    file_cnt=0

    # If necessary, prepend '.'
    [ "$(echo "$file_ext" | cut -c1)" != "." ] && file_ext=".$file_ext"

    # Escape '.'
    file_ext="$(echo "$file_ext" | sed 's/\./\\\./g')"

    # Search for readable files that match extension
    for f in *; do
        [ "$f" = "*" ] && break
        [ ! -f "$f" ] && continue
        if [ $(expr "$(echo "$f" | tr '[:upper:]' '[:lower:]')" : ".\+$file_ext$") -gt 0 ]; then
            file_list="$f"
            file_cnt=$((file_cnt + 1))
        fi
    done

    # Allow only a single file
    [ $file_cnt -eq 1 ] || file_list=""
    echo "$file_list"

    unset file_ext file_list file_cnt f
}

